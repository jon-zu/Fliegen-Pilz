using FliegenPilz.Crypto;
using JetBrains.Annotations;
using Xunit;

namespace FliegenPilz.Tests.Crypto;

[TestSubject(typeof(PacketCipher))]
public class PacketCipherTest
{
    [Fact]
    public void EncryptDecrypt()
    {
        var data = "abcdef"u8.ToArray();
        var cipher = new PacketCipher(new RoundKey(0));

        cipher.Encrypt(data);
        Assert.Equal(data, new byte[]
        {
            96,
            0,
            71,
            59,
            103,
            37
        });
        cipher.Decrypt(data);
        Assert.Equal(data, "abcdef"u8.ToArray());

        var dataExpected4096 = new byte[]
        {
            1,
            98,
            36,
            95,
            2,
            67,
            67,
            226,
            247,
            192,
            249,
            87,
            39,
            124,
            68,
            62,
            251,
            48,
            101,
            116,
            29,
            189,
            44,
            188,
            43,
            213,
            61,
            161,
            161,
            197,
            164,
            141,
            49,
            182,
            162,
            44,
            80,
            162,
            237,
            91,
            150,
            102,
            159,
            243,
            176,
            118,
            204,
            212,
            3,
            160,
            96,
            94,
            140,
            104,
            189,
            162,
            130,
            170,
            167,
            44,
            111,
            249,
            155,
            59,
            154,
            238,
            118,
            97,
            155,
            24,
            110,
            10,
            136,
            86,
            171,
            38,
            0,
            161,
            156,
            56,
            116,
            86,
            164,
            172,
            87,
            145,
            102,
            234,
            243,
            249,
            169,
            21,
            107,
            82,
            24,
            111,
            181,
            230,
            207,
            128,
            115,
            14,
            43,
            107,
            86,
            208,
            98,
            79,
            122,
            26,
            164,
            19,
            202,
            192,
            128,
            131,
            255,
            31,
            74,
            81,
            80,
            199,
            94,
            216,
            246,
            42,
            97,
            101,
            155,
            145,
            111,
            37,
            219,
            129,
            191,
            26,
            90,
            32,
            216,
            32,
            220,
            38,
            26,
            41,
            236,
            235,
            97,
            111,
            37,
            10,
            21,
            161,
            141,
            26,
            59,
            128,
            236,
            94,
            73,
            54,
            197,
            65,
            211,
            21,
            211,
            31,
            143,
            250,
            161,
            108,
            99,
            101,
            2,
            204,
            94,
            124,
            233,
            160,
            217,
            26,
            73,
            219,
            18,
            184,
            88,
            3,
            64,
            248,
            8,
            168,
            14,
            223,
            34,
            70,
            33,
            22,
            251,
            49,
            100,
            165,
            42,
            212,
            8,
            215,
            175,
            247,
            154,
            210,
            244,
            83,
            75,
            172,
            251,
            114,
            237,
            205,
            9,
            248,
            178,
            213,
            61,
            230,
            3,
            106,
            215,
            168,
            53,
            100,
            141,
            3,
            113,
            192,
            255,
            13,
            186,
            147,
            219,
            55,
            105,
            235,
            96,
            238,
            218,
            110,
            83,
            214,
            36,
            224,
            195,
            70,
            119,
            191,
            139,
            204,
            175,
            178,
            184,
            62,
            221,
            125,
            95,
            2,
            233,
            159,
            14,
            248,
            138,
            26,
            52,
            156,
            200,
            138,
            131,
            109,
            24,
            199,
            116,
            223,
            29,
            107,
            25,
            28,
            223,
            98,
            23,
            142,
            238,
            171,
            55,
            87,
            51,
            29,
            149,
            92,
            228,
            236,
            157,
            237,
            147,
            11,
            246,
            50,
            178,
            182,
            170,
            176,
            246,
            77,
            122,
            194,
            46,
            84,
            160,
            240,
            174,
            20,
            76,
            173,
            240,
            1,
            213,
            3,
            134,
            79,
            213,
            132,
            228,
            78,
            156,
            237,
            117,
            115,
            1,
            107,
            227,
            89,
            241,
            192,
            254,
            73,
            158,
            28,
            72,
            21,
            10,
            241,
            29,
            42,
            114,
            167,
            79,
            78,
            136,
            201,
            190,
            62,
            76,
            203,
            106,
            93,
            87,
            185,
            69,
            228,
            227,
            4,
            142,
            178,
            81,
            234,
            218,
            51,
            189,
            62,
            70,
            94,
            241,
            181,
            118,
            149,
            54,
            84,
            17,
            150,
            98,
            22,
            92,
            3,
            211,
            153,
            155,
            105,
            212,
            151,
            212,
            192,
            28,
            99,
            108,
            60,
            245,
            42,
            22,
            186,
            156,
            85,
            150,
            199,
            121,
            93,
            98,
            47,
            194,
            25,
            84,
            179,
            207,
            54,
            6,
            196,
            240,
            193,
            122,
            236,
            178,
            199,
            164,
            14,
            27,
            113,
            73,
            154,
            13,
            169,
            142,
            243,
            255,
            189,
            47,
            67,
            250,
            247,
            128,
            40,
            23,
            146,
            21,
            241,
            90,
            12,
            163,
            95,
            198,
            18,
            235,
            164,
            197,
            31,
            24,
            151,
            214,
            98,
            225,
            142,
            97,
            172,
            104,
            191,
            103,
            176,
            147,
            232,
            157,
            227,
            196,
            111,
            13,
            158,
            79,
            95,
            4,
            162,
            16,
            4,
            57,
            176,
            74,
            243,
            116,
            208,
            253,
            75,
            240,
            235,
            189,
            103,
            228,
            150,
            137,
            218,
            52,
            59,
            2,
            190,
            239,
            124,
            67,
            5,
            33,
            12,
            135,
            77,
            100,
            84,
            179,
            30,
            233,
            195,
            249,
            163,
            242,
            197,
            254,
            57,
            98,
            44,
            168,
            33,
            235,
            175,
            61,
            121,
            102,
            40,
            110,
            72,
            140,
            213,
            44,
            153,
            74,
            218,
            231,
            178,
            92,
            11,
            242,
            167,
            71,
            246,
            6,
            103,
            233,
            206,
            142,
            161,
            231,
            214,
            212,
            37,
            118,
            221,
            178,
            112,
            98,
            17,
            152,
            246,
            88,
            235,
            144,
            169,
            172,
            242,
            223,
            129,
            68,
            97,
            127,
            52,
            124,
            174,
            204,
            99,
            87,
            131,
            171,
            92,
            172,
            105,
            251,
            141,
            47,
            102,
            175,
            236,
            66,
            44,
            68,
            18,
            136,
            75,
            124,
            38,
            245,
            244,
            111,
            211,
            186,
            179,
            181,
            5,
            22,
            24,
            252,
            178,
            9,
            237,
            185,
            109,
            47,
            238,
            227,
            206,
            112,
            63,
            242,
            123,
            28,
            138,
            109,
            98,
            170,
            97,
            217,
            24,
            6,
            148,
            55,
            71,
            31,
            168,
            113,
            34,
            170,
            14,
            42,
            103,
            200,
            11,
            80,
            65,
            210,
            93,
            108,
            150,
            80,
            206,
            159,
            248,
            117,
            71,
            239,
            182,
            127,
            243,
            176,
            130,
            102,
            242,
            186,
            23,
            107,
            51,
            233,
            215,
            32,
            97,
            0,
            105,
            14,
            30,
            120,
            59,
            75,
            8,
            227,
            181,
            216,
            67,
            205,
            199,
            163,
            89,
            148,
            246,
            56,
            148,
            1,
            138,
            81,
            170,
            148,
            38,
            37,
            35,
            73,
            61,
            45,
            137,
            37,
            128,
            137,
            139,
            195,
            3,
            74,
            204,
            240,
            238,
            101,
            90,
            195,
            44,
            136,
            93,
            87,
            61,
            205,
            159,
            150,
            41,
            177,
            117,
            169,
            128,
            54,
            244,
            88,
            149,
            62,
            12,
            31,
            225,
            50,
            132,
            97,
            136,
            238,
            161,
            170,
            150,
            242,
            248,
            157,
            83,
            11,
            151,
            65,
            207,
            244,
            222,
            168,
            133,
            227,
            49,
            200,
            112,
            59,
            236,
            131,
            1,
            112,
            162,
            252,
            50,
            0,
            8,
            133,
            102,
            9,
            44,
            108,
            226,
            174,
            40,
            58,
            143,
            144,
            139,
            20,
            152,
            76,
            1,
            33,
            142,
            33,
            174,
            102,
            34,
            212,
            86,
            46,
            235,
            88,
            163,
            158,
            204,
            58,
            170,
            59,
            212,
            158,
            2,
            170,
            235,
            89,
            44,
            61,
            39,
            158,
            211,
            101,
            114,
            50,
            32,
            81,
            169,
            57,
            132,
            171,
            139,
            175,
            148,
            188,
            215,
            181,
            186,
            238,
            53,
            165,
            157,
            7,
            227,
            201,
            76,
            82,
            99,
            114,
            219,
            216,
            231,
            170,
            236,
            232,
            63,
            100,
            13,
            78,
            30,
            195,
            236,
            237,
            200,
            19,
            151,
            88,
            33,
            129,
            73,
            129,
            193,
            34,
            220,
            24,
            68,
            223,
            169,
            136,
            17,
            128,
            61,
            97,
            178,
            235,
            79,
            11,
            114,
            33,
            99,
            22,
            40,
            86,
            33,
            146,
            53,
            79,
            111,
            11,
            146,
            95,
            144,
            152,
            157,
            134,
            248,
            240,
            51,
            184,
            119,
            193,
            88,
            103,
            222,
            148,
            204,
            34,
            111,
            48,
            118,
            104,
            132,
            33,
            88,
            231,
            114,
            16,
            62,
            147,
            55,
            191,
            253,
            140,
            167,
            153,
            221,
            226,
            89,
            226,
            132,
            143,
            231,
            48,
            160,
            163,
            154,
            139,
            153,
            139,
            235,
            42,
            241,
            42,
            150,
            140,
            68,
            174,
            79,
            211,
            125,
            233,
            29,
            225,
            128,
            115,
            183,
            209,
            143,
            230,
            11,
            44,
            84,
            115,
            67,
            233,
            78,
            80,
            3,
            247,
            186,
            94,
            21,
            149,
            173,
            42,
            226,
            58,
            120,
            245,
            226,
            155,
            87,
            31,
            212,
            226,
            150,
            30,
            109,
            41,
            225,
            173,
            107,
            75,
            172,
            31,
            35,
            221,
            110,
            50,
            238,
            248,
            108,
            32,
            252,
            83,
            1,
            162,
            143,
            227,
            167,
            84,
            152,
            116,
            220,
            242,
            131,
            142,
            209,
            67,
            94,
            19,
            106,
            193,
            143,
            120,
            229,
            136,
            196,
            241,
            242,
            119,
            238,
            84,
            39,
            237,
            49,
            154,
            52,
            18,
            159,
            27,
            124,
            147,
            159,
            219,
            101,
            93,
            167,
            47,
            116,
            81,
            176,
            56,
            117,
            117,
            106,
            53,
            85,
            79,
            140,
            215,
            2,
            54,
            14,
            250,
            165,
            202,
            237,
            175,
            255,
            77,
            71,
            90,
            252,
            18,
            113,
            45,
            98,
            80,
            26,
            253,
            134,
            95,
            190,
            28,
            227,
            192,
            248,
            172,
            193,
            204,
            163,
            220,
            88,
            194,
            178,
            137,
            68,
            96,
            56,
            174,
            171,
            42,
            162,
            60,
            168,
            195,
            136,
            69,
            121,
            96,
            19,
            160,
            249,
            247,
            16,
            128,
            78,
            45,
            187,
            91,
            184,
            84,
            115,
            108,
            253,
            98,
            168,
            11,
            248,
            133,
            130,
            18,
            205,
            131,
            191,
            108,
            83,
            252,
            139,
            188,
            199,
            201,
            232,
            108,
            122,
            149,
            81,
            163,
            104,
            77,
            7,
            38,
            126,
            89,
            122,
            202,
            161,
            166,
            253,
            97,
            33,
            237,
            30,
            230,
            25,
            13,
            58,
            253,
            41,
            74,
            58,
            115,
            230,
            169,
            145,
            112,
            59,
            78,
            3,
            203,
            34,
            38,
            67,
            229,
            79,
            154,
            115,
            126,
            233,
            168,
            198,
            111,
            99,
            84,
            58,
            134,
            3,
            186,
            205,
            187,
            104,
            211,
            168,
            187,
            144,
            91,
            144,
            248,
            91,
            24,
            8,
            85,
            151,
            55,
            207,
            164,
            144,
            8,
            166,
            74,
            176,
            106,
            17,
            246,
            59,
            128,
            225,
            212,
            63,
            67,
            130,
            178,
            1,
            227,
            17,
            78,
            25,
            21,
            41,
            147,
            91,
            83,
            185,
            105,
            162,
            218,
            58,
            180,
            174,
            249,
            97,
            183,
            36,
            119,
            51,
            153,
            52,
            2,
            159,
            199,
            77,
            109,
            68,
            152,
            74,
            212,
            42,
            104,
            66,
            186,
            216,
            250,
            12,
            201,
            71,
            250,
            78,
            42,
            10,
            212,
            120,
            7,
            14,
            45,
            114,
            98,
            18,
            10,
            252,
            250,
            38,
            254,
            120,
            41,
            218,
            174,
            89,
            167,
            120,
            13,
            232,
            128,
            217,
            3,
            218,
            194,
            2,
            203,
            12,
            195,
            12,
            162,
            213,
            244,
            249,
            36,
            149,
            226,
            76,
            59,
            189,
            32,
            205,
            87,
            10,
            112,
            113,
            175,
            134,
            56,
            94,
            4,
            107,
            189,
            139,
            110,
            109,
            202,
            166,
            76,
            154,
            118,
            101,
            138,
            204,
            31,
            66,
            194,
            69,
            38,
            246,
            161,
            54,
            88,
            6,
            138,
            253,
            68,
            177,
            199,
            221,
            202,
            215,
            97,
            207,
            76,
            176,
            84,
            55,
            19,
            20,
            1,
            25,
            163,
            118,
            16,
            222,
            203,
            146,
            75,
            218,
            193,
            152,
            47,
            185,
            251,
            145,
            196,
            240,
            150,
            190,
            29,
            164,
            165,
            186,
            0,
            10,
            239,
            139,
            198,
            194,
            111,
            83,
            137,
            156,
            155,
            115,
            136,
            0,
            91,
            40,
            3,
            179,
            181,
            178,
            176,
            197,
            78,
            146,
            124,
            191,
            30,
            106,
            130,
            71,
            223,
            217,
            1,
            107,
            2,
            42,
            191,
            129,
            98,
            249,
            129,
            110,
            58,
            45,
            29,
            151,
            231,
            235,
            142,
            237,
            1,
            98,
            36,
            95,
            2,
            67,
            67,
            226,
            247,
            192,
            249,
            87,
            39,
            124,
            68,
            62,
            251,
            48,
            101,
            116,
            29,
            189,
            44,
            188,
            43,
            213,
            61,
            161,
            161,
            197,
            164,
            141,
            49,
            182,
            162,
            44,
            80,
            162,
            237,
            91,
            150,
            102,
            159,
            243,
            176,
            118,
            204,
            212,
            3,
            160,
            96,
            94,
            140,
            104,
            189,
            162,
            130,
            170,
            167,
            44,
            111,
            249,
            155,
            59,
            154,
            238,
            118,
            97,
            155,
            24,
            110,
            10,
            136,
            86,
            171,
            38,
            0,
            161,
            156,
            56,
            116,
            86,
            164,
            172,
            87,
            145,
            102,
            234,
            243,
            249,
            169,
            21,
            107,
            82,
            24,
            111,
            181,
            230,
            207,
            128,
            115,
            14,
            43,
            107,
            86,
            208,
            98,
            79,
            122,
            26,
            164,
            19,
            202,
            192,
            128,
            131,
            255,
            31,
            74,
            81,
            80,
            199,
            94,
            216,
            246,
            42,
            97,
            101,
            155,
            145,
            111,
            37,
            219,
            129,
            191,
            26,
            90,
            32,
            216,
            32,
            220,
            38,
            26,
            41,
            236,
            235,
            97,
            111,
            37,
            10,
            21,
            161,
            141,
            26,
            59,
            128,
            236,
            94,
            73,
            54,
            197,
            65,
            211,
            21,
            211,
            31,
            143,
            250,
            161,
            108,
            99,
            101,
            2,
            204,
            94,
            124,
            233,
            160,
            217,
            26,
            73,
            219,
            18,
            184,
            88,
            3,
            64,
            248,
            8,
            168,
            14,
            223,
            34,
            70,
            33,
            22,
            251,
            49,
            100,
            165,
            42,
            212,
            8,
            215,
            175,
            247,
            154,
            210,
            244,
            83,
            75,
            172,
            251,
            114,
            237,
            205,
            9,
            248,
            178,
            213,
            61,
            230,
            3,
            106,
            215,
            168,
            53,
            100,
            141,
            3,
            113,
            192,
            255,
            13,
            186,
            147,
            219,
            55,
            105,
            235,
            96,
            238,
            218,
            110,
            83,
            214,
            36,
            224,
            195,
            70,
            119,
            191,
            139,
            204,
            175,
            178,
            184,
            62,
            221,
            125,
            95,
            2,
            233,
            159,
            14,
            248,
            138,
            26,
            52,
            156,
            200,
            138,
            131,
            109,
            24,
            199,
            116,
            223,
            29,
            107,
            25,
            28,
            223,
            98,
            23,
            142,
            238,
            171,
            55,
            87,
            51,
            29,
            149,
            92,
            228,
            236,
            157,
            237,
            147,
            11,
            246,
            50,
            178,
            182,
            170,
            176,
            246,
            77,
            122,
            194,
            46,
            84,
            160,
            240,
            174,
            20,
            76,
            173,
            240,
            1,
            213,
            3,
            134,
            79,
            213,
            132,
            228,
            78,
            156,
            237,
            117,
            115,
            1,
            107,
            227,
            89,
            241,
            192,
            254,
            73,
            158,
            28,
            72,
            21,
            10,
            241,
            29,
            42,
            114,
            167,
            79,
            78,
            136,
            201,
            190,
            62,
            76,
            203,
            106,
            93,
            87,
            185,
            69,
            228,
            227,
            4,
            142,
            178,
            81,
            234,
            218,
            51,
            189,
            62,
            70,
            94,
            241,
            181,
            118,
            149,
            54,
            84,
            17,
            150,
            98,
            22,
            92,
            3,
            211,
            153,
            155,
            105,
            212,
            151,
            212,
            192,
            28,
            99,
            108,
            60,
            245,
            42,
            22,
            186,
            156,
            85,
            150,
            199,
            121,
            93,
            98,
            47,
            194,
            25,
            84,
            179,
            207,
            54,
            6,
            196,
            240,
            193,
            122,
            236,
            178,
            199,
            164,
            14,
            27,
            113,
            73,
            154,
            13,
            169,
            142,
            243,
            255,
            189,
            47,
            67,
            250,
            247,
            128,
            40,
            23,
            146,
            21,
            241,
            90,
            12,
            163,
            95,
            198,
            18,
            235,
            164,
            197,
            31,
            24,
            151,
            214,
            98,
            225,
            142,
            97,
            172,
            104,
            191,
            103,
            176,
            147,
            232,
            157,
            227,
            196,
            111,
            13,
            158,
            79,
            95,
            4,
            162,
            16,
            4,
            57,
            176,
            74,
            243,
            116,
            208,
            253,
            75,
            240,
            235,
            189,
            103,
            228,
            150,
            137,
            218,
            52,
            59,
            2,
            190,
            239,
            124,
            67,
            5,
            33,
            12,
            135,
            77,
            100,
            84,
            179,
            30,
            233,
            195,
            249,
            163,
            242,
            197,
            254,
            57,
            98,
            44,
            168,
            33,
            235,
            175,
            61,
            121,
            102,
            40,
            110,
            72,
            140,
            213,
            44,
            153,
            74,
            218,
            231,
            178,
            92,
            11,
            242,
            167,
            71,
            246,
            6,
            103,
            233,
            206,
            142,
            161,
            231,
            214,
            212,
            37,
            118,
            221,
            178,
            112,
            98,
            17,
            152,
            246,
            88,
            235,
            144,
            169,
            172,
            242,
            223,
            129,
            68,
            97,
            127,
            52,
            124,
            174,
            204,
            99,
            87,
            131,
            171,
            92,
            172,
            105,
            251,
            141,
            47,
            102,
            175,
            236,
            66,
            44,
            68,
            18,
            136,
            75,
            124,
            38,
            245,
            244,
            111,
            211,
            186,
            179,
            181,
            5,
            22,
            24,
            252,
            178,
            9,
            237,
            185,
            109,
            47,
            238,
            227,
            206,
            112,
            63,
            242,
            123,
            28,
            138,
            109,
            98,
            170,
            97,
            217,
            24,
            6,
            148,
            55,
            71,
            31,
            168,
            113,
            34,
            170,
            14,
            42,
            103,
            200,
            11,
            80,
            65,
            210,
            93,
            108,
            150,
            80,
            206,
            159,
            248,
            117,
            71,
            239,
            182,
            127,
            243,
            176,
            130,
            102,
            242,
            186,
            23,
            107,
            51,
            233,
            215,
            32,
            97,
            0,
            105,
            14,
            30,
            120,
            59,
            75,
            8,
            227,
            181,
            216,
            67,
            205,
            199,
            163,
            89,
            148,
            246,
            56,
            148,
            1,
            138,
            81,
            170,
            148,
            38,
            37,
            35,
            73,
            61,
            45,
            137,
            37,
            128,
            137,
            139,
            195,
            3,
            74,
            204,
            240,
            238,
            101,
            90,
            195,
            44,
            136,
            93,
            87,
            61,
            205,
            159,
            150,
            41,
            177,
            117,
            169,
            128,
            54,
            244,
            88,
            149,
            62,
            12,
            31,
            225,
            50,
            132,
            97,
            136,
            238,
            161,
            170,
            150,
            242,
            248,
            157,
            83,
            11,
            151,
            65,
            207,
            244,
            222,
            168,
            133,
            227,
            49,
            200,
            112,
            59,
            236,
            131,
            1,
            112,
            162,
            252,
            50,
            0,
            8,
            133,
            102,
            9,
            44,
            108,
            226,
            174,
            40,
            58,
            143,
            144,
            139,
            20,
            152,
            76,
            1,
            33,
            142,
            33,
            174,
            102,
            34,
            212,
            86,
            46,
            235,
            88,
            163,
            158,
            204,
            58,
            170,
            59,
            212,
            158,
            2,
            170,
            235,
            89,
            44,
            61,
            39,
            158,
            211,
            101,
            114,
            50,
            32,
            81,
            169,
            57,
            132,
            171,
            139,
            175,
            148,
            188,
            215,
            181,
            186,
            238,
            53,
            165,
            157,
            7,
            227,
            201,
            76,
            82,
            99,
            114,
            219,
            216,
            231,
            170,
            236,
            232,
            63,
            100,
            13,
            78,
            30,
            195,
            236,
            237,
            200,
            19,
            151,
            88,
            33,
            129,
            73,
            129,
            193,
            34,
            220,
            24,
            68,
            223,
            169,
            136,
            17,
            128,
            61,
            97,
            178,
            235,
            79,
            11,
            114,
            33,
            99,
            22,
            40,
            86,
            33,
            146,
            53,
            79,
            111,
            11,
            146,
            95,
            144,
            152,
            157,
            134,
            248,
            240,
            51,
            184,
            119,
            193,
            88,
            103,
            222,
            148,
            204,
            34,
            111,
            48,
            118,
            104,
            132,
            33,
            88,
            231,
            114,
            16,
            62,
            147,
            55,
            191,
            253,
            140,
            167,
            153,
            221,
            226,
            89,
            226,
            132,
            143,
            231,
            48,
            160,
            163,
            154,
            139,
            153,
            139,
            235,
            42,
            241,
            42,
            150,
            140,
            68,
            174,
            79,
            211,
            125,
            233,
            29,
            225,
            128,
            115,
            183,
            209,
            143,
            230,
            11,
            44,
            84,
            115,
            67,
            233,
            78,
            80,
            3,
            247,
            186,
            94,
            21,
            149,
            173,
            42,
            226,
            58,
            120,
            245,
            226,
            155,
            87,
            31,
            212,
            226,
            150,
            30,
            109,
            41,
            225,
            173,
            107,
            75,
            172,
            31,
            35,
            221,
            110,
            50,
            238,
            248,
            108,
            32,
            252,
            83,
            1,
            162,
            143,
            227,
            167,
            84,
            152,
            116,
            220,
            242,
            131,
            142,
            209,
            67,
            94,
            19,
            106,
            193,
            143,
            120,
            229,
            136,
            196,
            241,
            242,
            119,
            238,
            84,
            39,
            237,
            49,
            154,
            52,
            18,
            159,
            27,
            124,
            147,
            159,
            219,
            101,
            93,
            167,
            47,
            116,
            81,
            176,
            56,
            117,
            117,
            106,
            53,
            85,
            79,
            140,
            215,
            2,
            54,
            14,
            250,
            165,
            202,
            237,
            175,
            255,
            77,
            71,
            90,
            252,
            18,
            113,
            45,
            98,
            80,
            26,
            253,
            134,
            95,
            190,
            28,
            227,
            192,
            248,
            172,
            193,
            204,
            163,
            220,
            88,
            194,
            178,
            137,
            68,
            96,
            56,
            174,
            171,
            42,
            162,
            60,
            168,
            195,
            136,
            69,
            121,
            96,
            19,
            160,
            249,
            247,
            16,
            128,
            78,
            45,
            187,
            91,
            184,
            84,
            115,
            108,
            253,
            98,
            168,
            11,
            248,
            133,
            130,
            18,
            205,
            131,
            191,
            108,
            83,
            252,
            139,
            188,
            199,
            201,
            232,
            108,
            122,
            149,
            81,
            163,
            104,
            77,
            7,
            38,
            126,
            89,
            122,
            202,
            161,
            166,
            253,
            97,
            33,
            237,
            30,
            230,
            25,
            13,
            58,
            253,
            41,
            74,
            58,
            115,
            230,
            169,
            145,
            112,
            59,
            78,
            3,
            203,
            34,
            38,
            67,
            229,
            79,
            154,
            115,
            126,
            233,
            168,
            198,
            111,
            99,
            84,
            58,
            134,
            3,
            186,
            205,
            187,
            104,
            211,
            168,
            187,
            144,
            91,
            144,
            248,
            91,
            24,
            8,
            85,
            151,
            55,
            207,
            164,
            144,
            8,
            166,
            74,
            176,
            106,
            17,
            246,
            59,
            128,
            225,
            212,
            63,
            67,
            130,
            178,
            1,
            227,
            17,
            78,
            25,
            21,
            41,
            147,
            91,
            83,
            185,
            105,
            162,
            218,
            58,
            180,
            174,
            249,
            97,
            183,
            36,
            119,
            51,
            153,
            52,
            2,
            159,
            199,
            77,
            109,
            68,
            152,
            74,
            212,
            42,
            104,
            66,
            186,
            216,
            250,
            12,
            201,
            71,
            250,
            78,
            42,
            10,
            212,
            120,
            7,
            14,
            45,
            114,
            98,
            18,
            10,
            252,
            250,
            38,
            254,
            120,
            41,
            218,
            174,
            89,
            167,
            120,
            13,
            232,
            128,
            217,
            3,
            218,
            194,
            2,
            203,
            12,
            195,
            12,
            162,
            213,
            244,
            249,
            36,
            149,
            226,
            76,
            59,
            189,
            32,
            205,
            87,
            10,
            112,
            113,
            175,
            134,
            56,
            94,
            4,
            107,
            189,
            139,
            110,
            109,
            202,
            166,
            76,
            154,
            118,
            101,
            138,
            204,
            31,
            66,
            194,
            69,
            38,
            246,
            161,
            54,
            88,
            6,
            138,
            253,
            68,
            177,
            199,
            221,
            202,
            215,
            97,
            207,
            76,
            176,
            84,
            55,
            19,
            20,
            1,
            25,
            163,
            118,
            16,
            222,
            203,
            146,
            75,
            218,
            193,
            152,
            47,
            185,
            251,
            145,
            196,
            240,
            150,
            190,
            29,
            164,
            165,
            186,
            0,
            10,
            239,
            139,
            198,
            194,
            111,
            83,
            137,
            156,
            155,
            115,
            136,
            0,
            91,
            40,
            3,
            179,
            181,
            178,
            176,
            197,
            78,
            146,
            124,
            191,
            30,
            106,
            130,
            71,
            223,
            217,
            1,
            107,
            2,
            42,
            191,
            129,
            98,
            249,
            129,
            110,
            58,
            45,
            29,
            151,
            231,
            235,
            142,
            237,
            142,
            251,
            154,
            55,
            1,
            98,
            36,
            95,
            2,
            67,
            67,
            226,
            247,
            192,
            249,
            87,
            39,
            124,
            68,
            62,
            251,
            48,
            101,
            116,
            29,
            189,
            44,
            188,
            43,
            213,
            61,
            161,
            161,
            197,
            164,
            141,
            49,
            182,
            162,
            44,
            80,
            162,
            237,
            91,
            150,
            102,
            159,
            243,
            176,
            118,
            204,
            212,
            3,
            160,
            96,
            94,
            140,
            104,
            189,
            162,
            130,
            170,
            167,
            44,
            111,
            249,
            155,
            59,
            154,
            238,
            118,
            97,
            155,
            24,
            110,
            10,
            136,
            86,
            171,
            38,
            0,
            161,
            156,
            56,
            116,
            86,
            164,
            172,
            87,
            145,
            102,
            234,
            243,
            249,
            169,
            21,
            107,
            82,
            24,
            111,
            181,
            230,
            207,
            128,
            115,
            14,
            43,
            107,
            86,
            208,
            98,
            79,
            122,
            26,
            164,
            19,
            202,
            192,
            128,
            131,
            255,
            31,
            74,
            81,
            80,
            199,
            94,
            216,
            246,
            42,
            97,
            101,
            155,
            145,
            111,
            37,
            219,
            129,
            191,
            26,
            90,
            32,
            216,
            32,
            220,
            38,
            26,
            41,
            236,
            235,
            97,
            111,
            37,
            10,
            21,
            161,
            141,
            26,
            59,
            128,
            236,
            94,
            73,
            54,
            197,
            65,
            211,
            21,
            211,
            31,
            143,
            250,
            161,
            108,
            99,
            101,
            2,
            204,
            94,
            124,
            233,
            160,
            217,
            26,
            73,
            219,
            18,
            184,
            88,
            3,
            64,
            248,
            8,
            168,
            14,
            223,
            34,
            70,
            33,
            22,
            251,
            49,
            100,
            165,
            42,
            212,
            8,
            215,
            175,
            247,
            154,
            210,
            244,
            83,
            75,
            172,
            251,
            114,
            237,
            205,
            9,
            248,
            178,
            213,
            61,
            230,
            3,
            106,
            215,
            168,
            53,
            100,
            141,
            3,
            113,
            192,
            255,
            13,
            186,
            147,
            219,
            55,
            105,
            235,
            96,
            238,
            218,
            110,
            83,
            214,
            36,
            224,
            195,
            70,
            119,
            191,
            139,
            204,
            175,
            178,
            184,
            62,
            221,
            125,
            95,
            2,
            233,
            159,
            14,
            248,
            138,
            26,
            52,
            156,
            200,
            138,
            131,
            109,
            24,
            199,
            116,
            223,
            29,
            107,
            25,
            28,
            223,
            98,
            23,
            142,
            238,
            171,
            55,
            87,
            51,
            29,
            149,
            92,
            228,
            236,
            157,
            237,
            147,
            11,
            246,
            50,
            178,
            182,
            170,
            176,
            246,
            77,
            122,
            194,
            46,
            84,
            160,
            240,
            174,
            20,
            76,
            173,
            240,
            1,
            213,
            3,
            134,
            79,
            213,
            132,
            228,
            78,
            156,
            237,
            117,
            115,
            1,
            107,
            227,
            89,
            241,
            192,
            254,
            73,
            158,
            28,
            72,
            21,
            10,
            241,
            29,
            42,
            114,
            167,
            79,
            78,
            136,
            201,
            190,
            62,
            76,
            203,
            106,
            93,
            87,
            185,
            69,
            228,
            227,
            4,
            142,
            178,
            81,
            234,
            218,
            51,
            189,
            62,
            70,
            94,
            241,
            181,
            118,
            149,
            54,
            84,
            17,
            150,
            98,
            22,
            92,
            3,
            211,
            153,
            155,
            105,
            212,
            151,
            212,
            192,
            28,
            99,
            108,
            60,
            245,
            42,
            22,
            186,
            156,
            85,
            150,
            199,
            121,
            93,
            98,
            47,
            194,
            25,
            84,
            179,
            207,
            54,
            6,
            196,
            240,
            193,
            122,
            236,
            178,
            199,
            164,
            14,
            27,
            113,
            73,
            154,
            13,
            169,
            142,
            243,
            255,
            189,
            47,
            67,
            250,
            247,
            128,
            40,
            23,
            146,
            21,
            241,
            90,
            12,
            163,
            95,
            198,
            18,
            235,
            164,
            197,
            31,
            24,
            151,
            214,
            98,
            225,
            142,
            97,
            172,
            104,
            191,
            103,
            176,
            147,
            232,
            157,
            227,
            196,
            111,
            13,
            158,
            79,
            95,
            4,
            162,
            16,
            4,
            57,
            176,
            74,
            243,
            116,
            208,
            253,
            75,
            240,
            235,
            189,
            103,
            228,
            150,
            137,
            218,
            52,
            59,
            2,
            190,
            239,
            124,
            67,
            5,
            33,
            12,
            135,
            77,
            100,
            84,
            179,
            30,
            233,
            195,
            249,
            163,
            242,
            197,
            254,
            57,
            98,
            44,
            168,
            33,
            235,
            175,
            61,
            121,
            102,
            40,
            110,
            72,
            140,
            213,
            44,
            153,
            74,
            218,
            231,
            178,
            92,
            11,
            242,
            167,
            71,
            246,
            6,
            103,
            233,
            206,
            142,
            161,
            231,
            214,
            212,
            37,
            118,
            221,
            178,
            112,
            98,
            17,
            152,
            246,
            88,
            235,
            144,
            169,
            172,
            242,
            223,
            129,
            68,
            97,
            127,
            52,
            124,
            174,
            204,
            99,
            87,
            131,
            171,
            92,
            172,
            105,
            251,
            141,
            47,
            102,
            175,
            236,
            66,
            44,
            68,
            18,
            136,
            75,
            124,
            38,
            245,
            244,
            111,
            211,
            186,
            179,
            181,
            5,
            22,
            24,
            252,
            178,
            9,
            237,
            185,
            109,
            47,
            238,
            227,
            206,
            112,
            63,
            242,
            123,
            28,
            138,
            109,
            98,
            170,
            97,
            217,
            24,
            6,
            148,
            55,
            71,
            31,
            168,
            113,
            34,
            170,
            14,
            42,
            103,
            200,
            11,
            80,
            65,
            210,
            93,
            108,
            150,
            80,
            206,
            159,
            248,
            117,
            71,
            239,
            182,
            127,
            243,
            176,
            130,
            102,
            242,
            186,
            23,
            107,
            51,
            233,
            215,
            32,
            97,
            0,
            105,
            14,
            30,
            120,
            59,
            75,
            8,
            227,
            181,
            216,
            67,
            205,
            199,
            163,
            89,
            148,
            246,
            56,
            148,
            1,
            138,
            81,
            170,
            148,
            38,
            37,
            35,
            73,
            61,
            45,
            137,
            37,
            128,
            137,
            139,
            195,
            3,
            74,
            204,
            240,
            238,
            101,
            90,
            195,
            44,
            136,
            93,
            87,
            61,
            205,
            159,
            150,
            41,
            177,
            117,
            169,
            128,
            54,
            244,
            88,
            149,
            62,
            12,
            31,
            225,
            50,
            132,
            97,
            136,
            238,
            161,
            170,
            150,
            242,
            248,
            157,
            83,
            11,
            151,
            65,
            207,
            244,
            222,
            168,
            133,
            227,
            49,
            200,
            112,
            59,
            236,
            131,
            1,
            112,
            162,
            252,
            50,
            0,
            8,
            133,
            102,
            9,
            44,
            108,
            226,
            174,
            40,
            58,
            143,
            144,
            139,
            20,
            152,
            76,
            1,
            33,
            142,
            33,
            174,
            102,
            34,
            212,
            86,
            46,
            235,
            88,
            163,
            158,
            204,
            58,
            170,
            59,
            212,
            158,
            2,
            170,
            235,
            89,
            44,
            61,
            39,
            158,
            211,
            101,
            114,
            50,
            32,
            81,
            169,
            57,
            132,
            171,
            139,
            175,
            148,
            188,
            215,
            181,
            186,
            238,
            53,
            165,
            157,
            7,
            227,
            201,
            76,
            82,
            99,
            114,
            219,
            216,
            231,
            170,
            236,
            232,
            63,
            100,
            13,
            78,
            30,
            195,
            236,
            237,
            200,
            19,
            151,
            88,
            33,
            129,
            73,
            129,
            193,
            34,
            220,
            24,
            68,
            223,
            169,
            136,
            17,
            128,
            61,
            97,
            178,
            235,
            79,
            11,
            114,
            33,
            99,
            22,
            40,
            86,
            33,
            146,
            53,
            79,
            111,
            11,
            146,
            95,
            144,
            152,
            157,
            134,
            248,
            240,
            51,
            184,
            119,
            193,
            88,
            103,
            222,
            148,
            204,
            34,
            111,
            48,
            118,
            104,
            132,
            33,
            88,
            231,
            114,
            16,
            62,
            147,
            55,
            191,
            253,
            140,
            167,
            153,
            221,
            226,
            89,
            226,
            132,
            143,
            231,
            48,
            160,
            163,
            154,
            139,
            153,
            139,
            235,
            42,
            241,
            42,
            150,
            140,
            68,
            174,
            79,
            211,
            125,
            233,
            29,
            225,
            128,
            115,
            183,
            209,
            143,
            230,
            11,
            44,
            84,
            115,
            67,
            233,
            78,
            80,
            3,
            247,
            186,
            94,
            21,
            149,
            173,
            42,
            226,
            58,
            120,
            245,
            226,
            155,
            87,
            31,
            212,
            226,
            150,
            30,
            109,
            41,
            225,
            173,
            107,
            75,
            172,
            31,
            35,
            221,
            110,
            50,
            238,
            248,
            108,
            32,
            252,
            83,
            1,
            162,
            143,
            227,
            167,
            84,
            152,
            116,
            220,
            242,
            131,
            142,
            209,
            67,
            94,
            19,
            106,
            193,
            143,
            120,
            229,
            136,
            196,
            241,
            242,
            119,
            238,
            84,
            39,
            237,
            49,
            154,
            52,
            18,
            159,
            27,
            124,
            147,
            159,
            219,
            101,
            93,
            167,
            47,
            116,
            81,
            176,
            56,
            117,
            117,
            106,
            53,
            85,
            79,
            140,
            215,
            2,
            54,
            14,
            250,
            165,
            202,
            237,
            175,
            255,
            77,
            71,
            90,
            252,
            18,
            113,
            45,
            98,
            80,
            26,
            253,
            134,
            95,
            190,
            28,
            227,
            192,
            248,
            172,
            193,
            204,
            163,
            220,
            88,
            194,
            178,
            137,
            68,
            96,
            56,
            174,
            171,
            42,
            162,
            60,
            168,
            195,
            136,
            69,
            121,
            96,
            19,
            160,
            249,
            247,
            16,
            128,
            78,
            45,
            187,
            91,
            184,
            84,
            115,
            108,
            253,
            98,
            168,
            11,
            248,
            133,
            130,
            18,
            205,
            131,
            191,
            108,
            83,
            252,
            139,
            188,
            199,
            201,
            232,
            108,
            122,
            149,
            81,
            163,
            104,
            77,
            7,
            38,
            126,
            89,
            122,
            202,
            161,
            166,
            253,
            97,
            33,
            237,
            30,
            230,
            25,
            13,
            58,
            253,
            41,
        };

        var data4096 = new byte[4096];
        cipher.Encrypt(data4096);
        Assert.Equal(data4096, dataExpected4096);
        cipher.Decrypt(data4096);
        Assert.Equal(data4096, new byte[4096]);
    }
}